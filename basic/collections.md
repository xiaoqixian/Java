---
author: lunar
date: Wed 02 Sep 2020 11:46:00 PM CST
---

## Java Collections 源码阅读

### DualPivotQuickSort

Java collections里面的双轴快速排序算法.

作为常见的基础算法之一, 足足写了3000多行. 然后这只是为了适应多种数据类型而做的让步, 所以存在大量的重载.

这里以int类型的排序为例.

#### 并非所有的排序都是使用快速排序

当需要排序的数组长度小于47时, 通过插入排序来代替快速排序.

如果需要排序的数组段位于数组的最左边, 则使用普通插入排序.

否则, 使用**对插入排序(pair insertion sort)**.

推测是在这个范围内, 快速排序和插入排序的性能相差不大.

#### 快速排序

首先复习一下快速排序的基本思想: 从数组中选择一个轴pivot, 然后将所有小于pivot的值放在数组的左边, 所有大于pivot的放在右边. 然后分别递归pivot左边的子数组和右边的子数组.

Java DualPivotQuickSort采用双轴快速排序的方法, 而普通快排只采用一个轴.

### ArrayList

ArrayList的初始容量为8

最大允许容量比整数的最大值小8

#### 容量的增长方式

新容量的大小为原先容量的三倍, 然后需要判定是否在允许容量范围之内. 如果在范围之内, 通过Arrays.copyOf()函数进行拷贝.


